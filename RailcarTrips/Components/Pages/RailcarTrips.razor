@using global::RailcarTrips.Models

<table class="table table-striped table-bordered">
    <thead class="table-dark">
        <tr>
            <th>TripId</th>
            <th>EquipmentId</th>
            <th>Origin City</th>
            <th>Start Date</th>
            <th>Destination City</th>
            <th>End Date</th>
            <th>Total Trip (Hr)</th>
            <th>UserName</th>
            <th>IsActive</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in PagedList)
        {
            <tr>
                <td>@item.TripId</td>
                <td>@item.EquipmetId</td>
                <td>@item.OriginCityName</td>
                <td>@item.StartDate</td>
                <td>@item.DestinationCityName</td>
                <td>@item.EndDate</td>
                <td>@item.TotalTripHours</td>
                <td>@item.UserName</td>
                <td>@item.isActive</td>
                <td>                    
                    <button type="button" class="btn btn-secondary btn-sm" @onclick="() => DetailsClicked(item.TripId)">Details</button>
                    <button type="button" class="btn btn-danger btn-sm" @onclick="() => DeleteClicked(item.TripId)">Delete</button>
                </td>
            </tr>
        }
    </tbody>
</table>
<div class="mt-3">
    <button class="btn btn-secondary"
            disabled="@(CurrentPage == 1)"
            @onclick="() => CurrentPage--">
        Previous
    </button>

    <span class="mx-2">Page @CurrentPage of @TotalPages</span>

    <button class="btn btn-secondary"
            disabled="@(CurrentPage == TotalPages)"
            @onclick="() => CurrentPage++">
        Next
    </button>
</div>


@code {
    [Parameter] 
    public IList<RailcarTrip_View> List { get; set; } = [];
    [Parameter]
    public EventCallback<int> OnDetails { get; set; }
    [Parameter]
    public EventCallback<int> OnDelete { get; set; }

    private int CurrentPage = 1;
    private int PageSize = 15;   // how many rows per page
    private int TotalPages => (int)Math.Ceiling((double)List.Count / PageSize);

    private IEnumerable<RailcarTrip_View> PagedList =>
        List.Skip((CurrentPage - 1) * PageSize).Take(PageSize);

    private async Task DetailsClicked(int id)
    {
        await OnDetails.InvokeAsync(id);
    }

    private async Task DeleteClicked(int id)
    {
        await OnDelete.InvokeAsync(id);
    }


}
